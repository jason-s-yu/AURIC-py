import xarray as xr
from dask.diagnostics import ProgressBar

altitudes = [
    1000.00, 955.94, 913.82, 873.56, 835.07, 798.28, 763.11, 729.49, 697.35, 666.62, 637.25, 609.18, 582.34, 556.68, 532.15, 508.71, 486.29, 464.87, 444.39, 424.81, 406.09, 388.20, 371.10, 354.75, 339.12, 324.18, 309.89, 296.24, 283.19, 270.71, 258.78, 247.38, 236.48, 226.06, 216.10, 206.58, 197.48, 188.78, 180.46, 172.51, 164.91, 157.64, 150.70, 144.06, 137.71, 131.64, 125.84, 120.30, 115.00, 114.00, 113.00, 112.00, 111.00, 110.00, 109.00, 108.00, 107.00, 106.00, 105.00, 104.00, 103.00, 102.00, 101.00, 100.00, 99.00, 98.00, 97.00, 96.00, 95.00, 94.00, 93.00, 92.00, 91.00, 90.00, 89.00, 88.00, 87.00, 86.00, 85.00, 84.00, 83.00, 82.00, 81.00, 80.00, 75.00, 70.00, 65.00, 60.00, 55.00, 50.00, 45.00, 40.00, 35.00, 30.00, 25.00, 20.00, 15.00, 10.00, 5.00, 0.00
]

ion = [
    1.271E+04, 2.048E+04, 3.228E+04, 4.981E+04, 7.533E+04, 1.117E+05, 1.623E+05, 2.312E+05, 3.230E+05, 4.421E+05, 5.927E+05, 7.774E+05, 9.966E+05, 1.247E+06, 1.520E+06, 1.802E+06, 2.073E+06, 2.308E+06, 2.482E+06, 2.570E+06, 2.561E+06, 2.465E+06, 2.290E+06, 2.052E+06, 1.774E+06, 1.481E+06, 1.198E+06, 9.439E+05, 7.325E+05, 5.691E+05, 4.530E+05, 3.787E+05, 3.381E+05, 3.223E+05, 3.228E+05, 3.324E+05, 3.449E+05, 3.558E+05, 3.616E+05, 3.602E+05, 3.508E+05, 3.341E+05, 3.120E+05, 2.876E+05, 2.647E+05, 2.467E+05, 2.359E+05, 2.314E+05, 2.288E+05, 2.279E+05, 2.266E+05, 2.248E+05, 2.226E+05, 2.197E+05, 2.161E+05, 2.117E+05, 2.063E+05, 2.000E+05, 1.927E+05, 1.843E+05, 1.749E+05, 1.644E+05, 1.530E+05, 1.407E+05, 1.278E+05, 1.144E+05, 1.009E+05, 8.735E+04, 7.420E+04, 6.170E+04, 5.011E+04, 3.966E+04, 3.051E+04, 2.277E+04, 1.643E+04, 1.145E+04, 7.685E+03, 4.969E+03, 3.100E+03, 1.876E+03, 1.113E+03, 6.602E+02, 4.005E+02, 2.542E+02, 4.667E+01, 8.815E+00, 1.267E+00, 1.325E-01, 9.567E-03, 4.505E-04, 1.292E-05, 2.093E-07, 1.822E-09, 1.780E-11, 1.250E-12, 1.232E-13, 1.088E-14, 8.491E-16, 5.815E-17, 0.000E+00
]

ionos = xr.Dataset(
    data_vars = {
        'ion': ('level', ion, { 'units': 'cm-3' })
    },
    coords = {
        'level': ('level', altitudes, { 'units': 'km' })
    }
)

with ProgressBar():
    ionos.to_netcdf('../../data/ionos.nc', compute=False).compute()

print(ionos)