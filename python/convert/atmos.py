import matplotlib.pyplot as plt

import xarray as xr
from dask.diagnostics import ProgressBar

import numpy as np

altitudes = [
    1000.00, 955.94, 913.82, 873.56, 835.07, 798.28, 763.11, 729.49, 697.35, 666.62, 637.25, 609.18, 582.34, 556.68, 532.15, 508.71, 486.29, 464.87, 444.39, 424.81, 406.09, 388.20, 371.10, 354.75, 339.12, 324.18, 309.89, 296.24, 283.19, 270.71, 258.78, 247.38, 236.48, 226.06, 216.10, 206.58, 197.48, 188.78, 180.46, 172.51, 164.91, 157.64, 150.70, 144.06, 137.71, 131.64, 125.84, 120.30, 115.00, 114.00, 113.00, 112.00, 111.00, 110.00, 109.00, 108.00, 107.00, 106.00, 105.00, 104.00, 103.00, 102.00, 101.00, 100.00, 99.00, 98.00, 97.00, 96.00, 95.00, 94.00, 93.00, 92.00, 91.00, 90.00, 89.00, 88.00, 87.00, 86.00, 85.00, 84.00, 83.00, 82.00, 81.00, 80.00, 75.00, 70.00, 65.00, 60.00, 55.00, 50.00, 45.00, 40.00, 35.00, 30.00, 25.00, 20.00, 15.00, 10.00, 5.00, 0.00
]

temperature = [
    1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.190E+03, 1.189E+03, 1.189E+03, 1.188E+03, 1.187E+03, 1.185E+03, 1.183E+03, 1.181E+03, 1.178E+03, 1.173E+03, 1.168E+03, 1.161E+03, 1.152E+03, 1.141E+03, 1.128E+03, 1.112E+03, 1.092E+03, 1.069E+03, 1.043E+03, 1.011E+03, 9.748E+02, 9.331E+02, 8.855E+02, 8.317E+02, 7.714E+02, 7.040E+02, 6.293E+02, 5.471E+02, 4.571E+02, 3.610E+02, 2.821E+02, 2.701E+02, 2.591E+02, 2.489E+02, 2.395E+02, 2.310E+02, 2.233E+02, 2.163E+02, 2.101E+02, 2.045E+02, 1.997E+02, 1.956E+02, 1.921E+02, 1.894E+02, 1.873E+02, 1.859E+02, 1.853E+02, 1.852E+02, 1.857E+02, 1.867E+02, 1.880E+02, 1.895E+02, 1.913E+02, 1.932E+02, 1.950E+02, 1.968E+02, 1.984E+02, 1.997E+02, 2.009E+02, 2.018E+02, 2.027E+02, 2.034E+02, 2.040E+02, 2.045E+02, 2.049E+02, 2.054E+02, 2.081E+02, 2.143E+02, 2.242E+02, 2.372E+02, 2.524E+02, 2.673E+02, 2.723E+02, 2.602E+02, 2.419E+02, 2.282E+02, 2.188E+02, 2.105E+02, 2.070E+02, 2.278E+02, 2.623E+02, 2.937E+02
]

N2 = [
    2.731E+01, 6.830E+01, 1.657E+02, 3.905E+02, 8.941E+02, 1.990E+03, 4.310E+03, 9.087E+03, 1.866E+04, 3.736E+04, 7.295E+04, 1.390E+05, 2.589E+05, 4.711E+05, 8.384E+05, 1.460E+06, 2.492E+06, 4.166E+06, 6.833E+06, 1.100E+07, 1.738E+07, 2.700E+07, 4.125E+07, 6.203E+07, 9.189E+07, 1.342E+08, 1.933E+08, 2.751E+08, 3.869E+08, 5.385E+08, 7.424E+08, 1.015E+09, 1.378E+09, 1.860E+09, 2.500E+09, 3.352E+09, 4.490E+09, 6.023E+09, 8.109E+09, 1.099E+10, 1.504E+10, 2.088E+10, 2.956E+10, 4.301E+10, 6.498E+10, 1.036E+11, 1.789E+11, 3.492E+11, 7.602E+11, 8.914E+11, 1.049E+12, 1.238E+12, 1.467E+12, 1.743E+12, 2.077E+12, 2.481E+12, 2.971E+12, 3.563E+12, 4.280E+12, 5.146E+12, 6.188E+12, 7.440E+12, 8.936E+12, 1.071E+13, 1.281E+13, 1.528E+13, 1.817E+13, 2.156E+13, 2.550E+13, 3.008E+13, 3.542E+13, 4.162E+13, 4.884E+13, 5.728E+13, 6.715E+13, 7.874E+13, 9.234E+13, 1.083E+14, 1.270E+14, 1.491E+14, 1.749E+14, 2.052E+14, 2.408E+14, 2.825E+14, 6.233E+14, 1.339E+15, 2.742E+15, 5.355E+15, 9.978E+15, 1.795E+16, 3.275E+16, 6.432E+16, 1.354E+17, 2.950E+17, 6.558E+17, 1.500E+18, 3.455E+18, 6.911E+18, 1.205E+19, 1.982E+19
]

O2 = [
    5.589E-02, 1.593E-01, 4.388E-01, 1.169E+00, 3.012E+00, 7.516E+00, 1.818E+01, 4.263E+01, 9.702E+01, 2.145E+02, 4.608E+02, 9.631E+02, 1.960E+03, 3.884E+03, 7.506E+03, 1.416E+04, 2.607E+04, 4.690E+04, 8.255E+04, 1.422E+05, 2.400E+05, 3.970E+05, 6.445E+05, 1.027E+06, 1.610E+06, 2.483E+06, 3.773E+06, 5.652E+06, 8.360E+06, 1.223E+07, 1.771E+07, 2.543E+07, 3.628E+07, 5.152E+07, 7.297E+07, 1.033E+08, 1.467E+08, 2.094E+08, 3.017E+08, 4.403E+08, 6.545E+08, 9.967E+08, 1.566E+09, 2.564E+09, 4.418E+09, 8.141E+09, 1.643E+10, 3.777E+10, 9.731E+10, 1.179E+11, 1.433E+11, 1.748E+11, 2.138E+11, 2.624E+11, 3.227E+11, 3.977E+11, 4.909E+11, 6.066E+11, 7.499E+11, 9.269E+11, 1.145E+12, 1.411E+12, 1.736E+12, 2.129E+12, 2.601E+12, 3.164E+12, 3.833E+12, 4.624E+12, 5.558E+12, 6.655E+12, 7.943E+12, 9.453E+12, 1.122E+13, 1.331E+13, 1.576E+13, 1.865E+13, 2.207E+13, 2.609E+13, 3.084E+13, 3.644E+13, 4.304E+13, 5.081E+13, 5.995E+13, 7.071E+13, 1.594E+14, 3.486E+14, 7.284E+14, 1.437E+15, 2.677E+15, 4.816E+15, 8.786E+15, 1.726E+16, 3.634E+16, 7.914E+16, 1.759E+17, 4.024E+17, 9.269E+17, 1.854E+18, 3.232E+18, 5.317E+18
]

O = [
    1.200E+05, 2.026E+05, 3.363E+05, 5.488E+05, 8.811E+05, 1.392E+06, 2.164E+06, 3.315E+06, 5.001E+06, 7.435E+06, 1.090E+07, 1.576E+07, 2.247E+07, 3.164E+07, 4.399E+07, 6.041E+07, 8.198E+07, 1.100E+08, 1.459E+08, 1.915E+08, 2.489E+08, 3.202E+08, 4.081E+08, 5.155E+08, 6.457E+08, 8.024E+08, 9.898E+08, 1.213E+09, 1.477E+09, 1.789E+09, 2.157E+09, 2.589E+09, 3.100E+09, 3.703E+09, 4.419E+09, 5.273E+09, 6.301E+09, 7.548E+09, 9.080E+09, 1.099E+10, 1.340E+10, 1.651E+10, 2.066E+10, 2.637E+10, 3.462E+10, 4.728E+10, 6.839E+10, 1.076E+11, 1.780E+11, 1.964E+11, 2.166E+11, 2.390E+11, 2.635E+11, 2.904E+11, 3.196E+11, 3.512E+11, 3.850E+11, 4.207E+11, 4.579E+11, 4.957E+11, 5.333E+11, 5.690E+11, 6.011E+11, 6.275E+11, 6.457E+11, 6.536E+11, 6.497E+11, 6.327E+11, 6.022E+11, 5.591E+11, 5.050E+11, 4.427E+11, 3.757E+11, 3.080E+11, 2.434E+11, 1.848E+11, 1.344E+11, 9.345E+10, 6.194E+10, 3.905E+10, 2.338E+10, 1.328E+10, 7.151E+09, 3.653E+09, 6.268E+07, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30
]

O3 = [
    5.831E-15, 2.806E-14, 1.283E-13, 5.574E-13, 2.306E-12, 9.091E-12, 3.418E-11, 1.227E-10, 4.214E-10, 1.384E-09, 4.358E-09, 1.316E-08, 3.814E-08, 1.063E-07, 2.851E-07, 7.363E-07, 1.834E-06, 4.408E-06, 1.024E-05, 2.299E-05, 4.999E-05, 1.053E-04, 2.151E-04, 4.267E-04, 8.226E-04, 1.544E-03, 2.823E-03, 5.040E-03, 8.797E-03, 1.505E-02, 2.527E-02, 4.177E-02, 6.817E-02, 1.102E-01, 1.771E-01, 2.840E-01, 4.567E-01, 7.406E-01, 1.219E+00, 2.051E+00, 3.566E+00, 6.485E+00, 1.254E+01, 2.636E+01, 6.212E+01, 1.715E+02, 5.913E+02, 2.736E+03, 1.468E+04, 2.048E+04, 2.875E+04, 4.069E+04, 5.812E+04, 8.394E+04, 1.226E+05, 1.814E+05, 2.714E+05, 4.102E+05, 6.252E+05, 9.573E+05, 1.467E+06, 2.238E+06, 3.380E+06, 5.024E+06, 7.306E+06, 1.036E+07, 1.428E+07, 1.912E+07, 2.481E+07, 3.115E+07, 3.780E+07, 4.431E+07, 5.015E+07, 5.480E+07, 5.782E+07, 5.875E+07, 5.736E+07, 5.369E+07, 5.535E+07, 5.754E+07, 6.092E+07, 6.559E+07, 8.494E+07, 1.102E+08, 4.299E+08, 1.054E+09, 1.009E+09, 1.595E+09, 3.788E+09, 1.284E+10, 4.286E+10, 1.470E+11, 4.828E+11, 1.732E+12, 6.229E+12, 7.585E+12, 4.632E+12, 2.101E+12, 1.044E+12, 1.365E+12
]

NO = [
    2.431E-07, 1.173E-06, 5.278E-06, 2.223E-05, 8.788E-05, 3.270E-04, 1.148E-03, 3.816E-03, 1.203E-02, 3.603E-02, 1.028E-01, 2.803E-01, 7.311E-01, 1.828E+00, 4.389E+00, 1.014E+01, 2.258E+01, 4.852E+01, 1.008E+02, 2.029E+02, 3.959E+02, 7.501E+02, 1.382E+03, 2.478E+03, 4.330E+03, 7.382E+03, 1.229E+04, 2.002E+04, 3.191E+04, 4.983E+04, 7.629E+04, 1.146E+05, 1.692E+05, 2.455E+05, 3.503E+05, 4.922E+05, 6.812E+05, 9.295E+05, 1.251E+06, 1.655E+06, 2.163E+06, 2.793E+06, 3.566E+06, 4.641E+06, 6.026E+06, 7.812E+06, 1.106E+07, 1.629E+07, 2.025E+07, 2.080E+07, 2.113E+07, 2.146E+07, 2.168E+07, 2.190E+07, 2.179E+07, 2.168E+07, 2.146E+07, 2.124E+07, 2.080E+07, 2.036E+07, 1.947E+07, 1.861E+07, 1.713E+07, 1.577E+07, 1.571E+07, 1.565E+07, 1.559E+07, 1.553E+07, 1.547E+07, 1.541E+07, 1.535E+07, 1.529E+07, 1.523E+07, 1.517E+07, 1.427E+07, 1.343E+07, 1.263E+07, 1.188E+07, 1.117E+07, 1.083E+07, 1.050E+07, 1.018E+07, 9.862E+06, 9.556E+06, 1.272E+07, 1.959E+07, 3.608E+07, 6.924E+07, 1.290E+08, 2.367E+08, 4.906E+08, 9.223E+08, 1.238E+09, 9.253E+08, 5.751E+08, 4.896E+08, 1.252E+09, 2.654E+09, 4.627E+09, 7.612E+09
]

N = [
    1.111E+04, 1.757E+04, 2.737E+04, 4.202E+04, 6.357E+04, 9.485E+04, 1.396E+05, 2.027E+05, 2.904E+05, 4.109E+05, 5.742E+05, 7.928E+05, 1.082E+06, 1.459E+06, 1.947E+06, 2.570E+06, 3.357E+06, 4.341E+06, 5.565E+06, 7.065E+06, 8.892E+06, 1.110E+07, 1.374E+07, 1.689E+07, 2.062E+07, 2.500E+07, 3.010E+07, 3.601E+07, 4.277E+07, 5.038E+07, 5.879E+07, 6.781E+07, 7.706E+07, 8.596E+07, 9.362E+07, 9.894E+07, 1.007E+08, 9.807E+07, 9.053E+07, 7.865E+07, 6.391E+07, 4.839E+07, 3.412E+07, 2.251E+07, 1.403E+07, 8.417E+06, 5.010E+06, 3.098E+06, 1.982E+06, 1.821E+06, 1.673E+06, 1.537E+06, 1.413E+06, 1.299E+06, 1.196E+06, 1.101E+06, 1.016E+06, 9.375E+05, 8.663E+05, 8.014E+05, 7.419E+05, 6.872E+05, 6.365E+05, 5.892E+05, 5.447E+05, 5.028E+05, 4.633E+05, 4.262E+05, 3.914E+05, 3.588E+05, 3.284E+05, 3.001E+05, 2.741E+05, 2.502E+05, 2.285E+05, 2.087E+05, 1.907E+05, 1.744E+05, 1.596E+05, 1.461E+05, 1.338E+05, 1.227E+05, 1.125E+05, 1.033E+05, 6.786E+04, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30
]

He = [
    8.138E+05, 9.277E+05, 1.053E+06, 1.190E+06, 1.340E+06, 1.502E+06, 1.677E+06, 1.866E+06, 2.068E+06, 2.283E+06, 2.512E+06, 2.755E+06, 3.011E+06, 3.279E+06, 3.561E+06, 3.855E+06, 4.161E+06, 4.478E+06, 4.807E+06, 5.146E+06, 5.495E+06, 5.853E+06, 6.221E+06, 6.598E+06, 6.985E+06, 7.381E+06, 7.787E+06, 8.203E+06, 8.633E+06, 9.076E+06, 9.537E+06, 1.002E+07, 1.052E+07, 1.106E+07, 1.163E+07, 1.225E+07, 1.295E+07, 1.370E+07, 1.456E+07, 1.553E+07, 1.667E+07, 1.801E+07, 1.964E+07, 2.167E+07, 2.426E+07, 2.770E+07, 3.253E+07, 3.986E+07, 5.020E+07, 5.258E+07, 5.515E+07, 5.793E+07, 6.095E+07, 6.428E+07, 6.798E+07, 7.212E+07, 7.679E+07, 8.210E+07, 8.818E+07, 9.519E+07, 1.033E+08, 1.127E+08, 1.237E+08, 1.364E+08, 1.511E+08, 1.682E+08, 1.880E+08, 2.110E+08, 2.377E+08, 2.686E+08, 3.045E+08, 3.462E+08, 3.948E+08, 4.515E+08, 5.179E+08, 5.959E+08, 6.873E+08, 7.947E+08, 9.207E+08, 1.069E+09, 1.242E+09, 1.446E+09, 1.685E+09, 1.966E+09, 4.255E+09, 9.063E+09, 1.845E+10, 3.594E+10, 6.696E+10, 1.205E+11, 2.198E+11, 4.317E+11, 9.090E+11, 1.980E+12, 4.401E+12, 1.007E+13, 2.319E+13, 4.638E+13, 8.084E+13, 1.330E+14
]

H = [
    3.636E+04, 3.757E+04, 3.878E+04, 3.999E+04, 4.119E+04, 4.238E+04, 4.357E+04, 4.475E+04, 4.591E+04, 4.706E+04, 4.820E+04, 4.933E+04, 5.043E+04, 5.152E+04, 5.260E+04, 5.365E+04, 5.469E+04, 5.571E+04, 5.671E+04, 5.769E+04, 5.866E+04, 5.961E+04, 6.055E+04, 6.148E+04, 6.241E+04, 6.334E+04, 6.437E+04, 6.540E+04, 6.652E+04, 6.777E+04, 6.924E+04, 7.104E+04, 7.333E+04, 7.635E+04, 8.048E+04, 8.624E+04, 9.446E+04, 1.064E+05, 1.240E+05, 1.505E+05, 1.909E+05, 2.538E+05, 3.531E+05, 5.117E+05, 7.666E+05, 1.179E+06, 1.856E+06, 2.997E+06, 4.818E+06, 5.264E+06, 5.749E+06, 6.275E+06, 6.846E+06, 7.468E+06, 8.146E+06, 8.886E+06, 9.698E+06, 1.059E+07, 1.158E+07, 1.268E+07, 1.390E+07, 1.528E+07, 1.684E+07, 1.860E+07, 2.061E+07, 2.291E+07, 2.557E+07, 2.863E+07, 3.219E+07, 3.633E+07, 4.114E+07, 4.673E+07, 5.321E+07, 6.068E+07, 6.916E+07, 7.853E+07, 8.836E+07, 9.771E+07, 1.048E+08, 1.066E+08, 9.946E+07, 8.048E+07, 5.165E+07, 2.275E+07, 3.543E-04, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30, 1.000E-30
]

Ar = [
    6.309E-06, 2.336E-05, 8.290E-05, 2.821E-04, 9.210E-04, 2.889E-03, 8.712E-03, 2.528E-02, 7.068E-02, 1.905E-01, 4.956E-01, 1.245E+00, 3.026E+00, 7.118E+00, 1.622E+01, 3.584E+01, 7.688E+01, 1.602E+02, 3.248E+02, 6.409E+02, 1.232E+03, 2.312E+03, 4.235E+03, 7.583E+03, 1.329E+04, 2.281E+04, 3.840E+04, 6.349E+04, 1.032E+05, 1.653E+05, 2.610E+05, 4.070E+05, 6.277E+05, 9.599E+05, 1.458E+06, 2.204E+06, 3.323E+06, 5.014E+06, 7.593E+06, 1.158E+07, 1.788E+07, 2.811E+07, 4.534E+07, 7.592E+07, 1.342E+08, 2.566E+08, 5.496E+08, 1.380E+09, 3.954E+09, 4.890E+09, 6.069E+09, 7.554E+09, 9.428E+09, 1.179E+10, 1.477E+10, 1.852E+10, 2.323E+10, 2.912E+10, 3.647E+10, 4.558E+10, 5.682E+10, 7.058E+10, 8.733E+10, 1.075E+11, 1.316E+11, 1.603E+11, 1.941E+11, 2.339E+11, 2.804E+11, 3.348E+11, 3.982E+11, 4.720E+11, 5.580E+11, 6.586E+11, 7.765E+11, 9.148E+11, 1.077E+12, 1.268E+12, 1.492E+12, 1.755E+12, 2.064E+12, 2.426E+12, 2.851E+12, 3.350E+12, 7.426E+12, 1.598E+13, 3.278E+13, 6.405E+13, 1.194E+14, 2.147E+14, 3.917E+14, 7.694E+14, 1.620E+15, 3.529E+15, 7.844E+15, 1.794E+16, 4.133E+16, 8.267E+16, 1.441E+17, 2.371E+17
]

atmos = xr.Dataset(
    data_vars = {
        'temperature': ('level', temperature, { 'units': 'K' }),
        'N2': ('level', N2, { 'units': 'cm-3' }),
        'O2': ('level', O2, { 'units': 'cm-3' }),
        'O': ('level', O, { 'units': 'cm-3' }),
        'O3': ('level', O3, { 'units': 'cm-3' }),
        'NO': ('level', NO, { 'units': 'cm-3' }),
        'N': ('level', N, { 'units': 'cm-3' }),
        'He': ('level', He, { 'units': 'cm-3' }),
        'H': ('level', H, { 'units': 'cm-3' }),
        'Ar': ('level', Ar, { 'units': 'cm-3' })
    },
    coords = {
        'level': ('level', altitudes, { 'units': 'km' })
    }
)

with ProgressBar():
    atmos.to_netcdf('../../data/atmos.nc', compute=False).compute()

print(atmos)