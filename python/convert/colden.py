import matplotlib.pyplot as plt

import xarray as xr
from dask.diagnostics import ProgressBar

import numpy as np

altitudes = [
    1000.00, 955.94, 913.82, 873.56, 835.07, 798.28, 763.11, 729.49, 697.35, 666.62, 637.25, 609.18, 582.34, 556.68, 532.15, 508.71, 486.29, 464.87, 444.39, 424.81, 406.09, 388.20, 371.10, 354.75, 339.12, 324.18, 309.89, 296.24, 283.19, 270.71, 258.78, 247.38, 236.48, 226.06, 216.10, 206.58, 197.48, 188.78, 180.46, 172.51, 164.91, 157.64, 150.70, 144.06, 137.71, 131.64, 125.84, 120.30, 115.00, 114.00, 113.00, 112.00, 111.00, 110.00, 109.00, 108.00, 107.00, 106.00, 105.00, 104.00, 103.00, 102.00, 101.00, 100.00, 99.00, 98.00, 97.00, 96.00, 95.00, 94.00, 93.00, 92.00, 91.00, 90.00, 89.00, 88.00, 87.00, 86.00, 85.00, 84.00, 83.00, 82.00, 81.00, 80.00, 75.00, 70.00, 65.00, 60.00, 55.00, 50.00, 45.00, 40.00, 35.00, 30.00, 25.00, 20.00, 15.00, 10.00, 5.00, 0.00
]

N2 = [
    1.142E+08, 3.427E+08, 8.795E+08, 2.104E+09, 4.817E+09, 1.066E+10, 2.290E+10, 4.787E+10, 9.746E+10, 1.934E+11, 3.746E+11, 7.081E+11, 1.308E+12, 2.363E+12, 4.175E+12, 7.221E+12, 1.224E+13, 2.033E+13, 3.313E+13, 5.300E+13, 8.328E+13, 1.286E+14, 1.953E+14, 2.918E+14, 4.295E+14, 6.231E+14, 8.914E+14, 1.258E+15, 1.754E+15, 2.418E+15, 3.296E+15, 4.448E+15, 5.947E+15, 7.888E+15, 1.039E+16, 1.359E+16, 1.769E+16, 2.295E+16, 2.971E+16, 3.843E+16, 4.979E+16, 6.476E+16, 8.479E+16, 1.123E+17, 1.513E+17, 2.092E+17, 3.009E+17, 4.626E+17, 7.843E+17, 8.799E+17, 9.922E+17, 1.124E+18, 1.281E+18, 1.467E+18, 1.688E+18, 1.951E+18, 2.267E+18, 2.644E+18, 3.098E+18, 3.643E+18, 4.299E+18, 5.087E+18, 6.032E+18, 7.169E+18, 8.529E+18, 1.015E+19, 1.209E+19, 1.439E+19, 1.711E+19, 2.033E+19, 2.412E+19, 2.857E+19, 3.381E+19, 3.995E+19, 4.715E+19, 5.559E+19, 6.549E+19, 7.710E+19, 9.071E+19, 1.067E+20, 1.254E+20, 1.474E+20, 1.732E+20, 2.035E+20, 4.536E+20, 9.980E+20, 2.137E+21, 4.410E+21, 8.731E+21, 1.661E+22, 3.083E+22, 5.779E+22, 1.129E+23, 2.315E+23, 4.928E+23, 1.084E+24, 2.450E+24, 5.374E+24, 1.078E+25, 1.985E+25
]

O2 = [
    2.045E+05, 7.092E+05, 2.057E+06, 5.536E+06, 1.423E+07, 3.524E+07, 8.449E+07, 1.963E+08, 4.429E+08, 9.706E+08, 2.068E+09, 4.286E+09, 8.653E+09, 1.702E+10, 3.266E+10, 6.116E+10, 1.119E+11, 2.000E+11, 3.498E+11, 5.988E+11, 1.004E+12, 1.652E+12, 2.664E+12, 4.221E+12, 6.571E+12, 1.006E+13, 1.517E+13, 2.253E+13, 3.299E+13, 4.771E+13, 6.818E+13, 9.637E+13, 1.349E+14, 1.874E+14, 2.585E+14, 3.547E+14, 4.851E+14, 6.625E+14, 9.058E+14, 1.243E+15, 1.718E+15, 2.401E+15, 3.411E+15, 4.961E+15, 7.453E+15, 1.170E+16, 1.955E+16, 3.582E+16, 7.411E+16, 8.656E+16, 1.017E+17, 1.200E+17, 1.425E+17, 1.700E+17, 2.038E+17, 2.455E+17, 2.968E+17, 3.603E+17, 4.387E+17, 5.356E+17, 6.553E+17, 8.031E+17, 9.846E+17, 1.208E+18, 1.481E+18, 1.815E+18, 2.219E+18, 2.708E+18, 3.297E+18, 4.004E+18, 4.848E+18, 5.855E+18, 7.051E+18, 8.470E+18, 1.015E+19, 1.214E+19, 1.450E+19, 1.728E+19, 2.058E+19, 2.447E+19, 2.907E+19, 3.450E+19, 4.090E+19, 4.846E+19, 1.119E+20, 2.525E+20, 5.526E+20, 1.160E+21, 2.320E+21, 4.434E+21, 8.248E+21, 1.548E+22, 3.028E+22, 6.209E+22, 1.322E+23, 2.907E+23, 6.574E+23, 1.442E+24, 2.891E+24, 5.325E+24
]

O = [
    8.781E+11, 1.684E+12, 2.972E+12, 4.998E+12, 8.130E+12, 1.290E+13, 2.003E+13, 3.055E+13, 4.583E+13, 6.770E+13, 9.854E+13, 1.414E+14, 2.003E+14, 2.800E+14, 3.866E+14, 5.273E+14, 7.110E+14, 9.477E+14, 1.250E+15, 1.630E+15, 2.105E+15, 2.693E+15, 3.411E+15, 4.283E+15, 5.331E+15, 6.580E+15, 8.059E+15, 9.796E+15, 1.182E+16, 1.418E+16, 1.690E+16, 2.003E+16, 2.361E+16, 2.771E+16, 3.239E+16, 3.772E+16, 4.380E+16, 5.076E+16, 5.875E+16, 6.797E+16, 7.866E+16, 9.120E+16, 1.061E+17, 1.240E+17, 1.463E+17, 1.747E+17, 2.129E+17, 2.681E+17, 3.537E+17, 3.754E+17, 3.994E+17, 4.258E+17, 4.549E+17, 4.870E+17, 5.223E+17, 5.612E+17, 6.039E+17, 6.506E+17, 7.015E+17, 7.568E+17, 8.165E+17, 8.804E+17, 9.482E+17, 1.020E+18, 1.093E+18, 1.169E+18, 1.245E+18, 1.319E+18, 1.391E+18, 1.458E+18, 1.520E+18, 1.575E+18, 1.623E+18, 1.662E+18, 1.694E+18, 1.719E+18, 1.737E+18, 1.750E+18, 1.759E+18, 1.765E+18, 1.769E+18, 1.771E+18, 1.772E+18, 1.772E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18, 1.773E+18
]

O3 = [
    1.422E-08, 8.662E-08, 4.090E-07, 1.774E-06, 7.275E-06, 2.839E-05, 1.057E-04, 3.759E-04, 1.279E-03, 4.165E-03, 1.300E-02, 3.894E-02, 1.120E-01, 3.100E-01, 8.258E-01, 2.119E+00, 5.247E+00, 1.254E+01, 2.898E+01, 6.479E+01, 1.403E+02, 2.943E+02, 5.993E+02, 1.185E+03, 2.279E+03, 4.264E+03, 7.777E+03, 1.383E+04, 2.404E+04, 4.089E+04, 6.817E+04, 1.115E+05, 1.796E+05, 2.853E+05, 4.479E+05, 6.974E+05, 1.080E+06, 1.671E+06, 2.595E+06, 4.063E+06, 6.465E+06, 1.055E+07, 1.788E+07, 3.206E+07, 6.236E+07, 1.368E+08, 3.594E+08, 1.241E+09, 5.565E+09, 7.587E+09, 1.042E+10, 1.441E+10, 2.008E+10, 2.823E+10, 4.007E+10, 5.749E+10, 8.342E+10, 1.224E+11, 1.817E+11, 2.722E+11, 4.110E+11, 6.232E+11, 9.436E+11, 1.425E+12, 2.134E+12, 3.150E+12, 4.570E+12, 6.498E+12, 9.038E+12, 1.228E+13, 1.627E+13, 2.104E+13, 2.652E+13, 3.262E+13, 3.917E+13, 4.595E+13, 5.271E+13, 5.912E+13, 6.542E+13, 7.196E+13, 7.882E+13, 8.610E+13, 9.470E+13, 1.060E+14, 2.446E+14, 6.900E+14, 1.288E+15, 1.991E+15, 3.416E+15, 7.665E+15, 2.210E+16, 7.114E+16, 2.345E+17, 7.996E+17, 3.010E+18, 7.136E+18, 1.080E+19, 1.268E+19, 1.351E+19, 1.419E+19
]

NO = [
    9.487E-01, 3.975E+00, 1.734E+01, 7.249E+01, 2.861E+02, 1.064E+03, 3.734E+03, 1.241E+04, 3.910E+04, 1.172E+05, 3.343E+05, 9.109E+05, 2.376E+06, 5.940E+06, 1.426E+07, 3.294E+07, 7.337E+07, 1.577E+08, 3.276E+08, 6.591E+08, 1.286E+09, 2.436E+09, 4.488E+09, 8.048E+09, 1.406E+10, 2.398E+10, 3.994E+10, 6.502E+10, 1.036E+11, 1.618E+11, 2.478E+11, 3.723E+11, 5.494E+11, 7.972E+11, 1.138E+12, 1.598E+12, 2.212E+12, 3.018E+12, 4.063E+12, 5.394E+12, 7.067E+12, 9.145E+12, 1.169E+13, 1.482E+13, 1.873E+13, 2.355E+13, 2.979E+13, 3.851E+13, 4.982E+13, 5.221E+13, 5.464E+13, 5.711E+13, 5.961E+13, 6.214E+13, 6.467E+13, 6.719E+13, 6.970E+13, 7.217E+13, 7.461E+13, 7.700E+13, 7.931E+13, 8.152E+13, 8.360E+13, 8.549E+13, 8.732E+13, 8.913E+13, 9.095E+13, 9.275E+13, 9.455E+13, 9.634E+13, 9.812E+13, 9.990E+13, 1.017E+14, 1.034E+14, 1.051E+14, 1.068E+14, 1.083E+14, 1.097E+14, 1.110E+14, 1.123E+14, 1.135E+14, 1.147E+14, 1.159E+14, 1.170E+14, 1.232E+14, 1.323E+14, 1.479E+14, 1.773E+14, 2.331E+14, 3.355E+14, 5.374E+14, 9.414E+14, 1.588E+15, 2.231E+15, 2.656E+15, 2.956E+15, 3.400E+15, 4.499E+15, 6.578E+15, 1.006E+16
]

N = [
    9.291E+10, 1.649E+11, 2.729E+11, 4.324E+11, 6.647E+11, 9.981E+11, 1.470E+12, 2.130E+12, 3.039E+12, 4.276E+12, 5.938E+12, 8.143E+12, 1.104E+13, 1.479E+13, 1.960E+13, 2.570E+13, 3.336E+13, 4.287E+13, 5.457E+13, 6.884E+13, 8.608E+13, 1.067E+14, 1.313E+14, 1.602E+14, 1.941E+14, 2.335E+14, 2.790E+14, 3.312E+14, 3.906E+14, 4.579E+14, 5.333E+14, 6.169E+14, 7.084E+14, 8.069E+14, 9.108E+14, 1.017E+15, 1.123E+15, 1.224E+15, 1.315E+15, 1.393E+15, 1.456E+15, 1.504E+15, 1.537E+15, 1.558E+15, 1.572E+15, 1.580E+15, 1.584E+15, 1.587E+15, 1.588E+15, 1.588E+15, 1.588E+15, 1.589E+15, 1.589E+15, 1.589E+15, 1.589E+15, 1.589E+15, 1.589E+15, 1.589E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.590E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15, 1.591E+15
]

He = [
    2.382E+13, 2.826E+13, 3.309E+13, 3.832E+13, 4.396E+13, 5.002E+13, 5.649E+13, 6.339E+13, 7.071E+13, 7.846E+13, 8.662E+13, 9.519E+13, 1.042E+14, 1.135E+14, 1.232E+14, 1.333E+14, 1.437E+14, 1.544E+14, 1.655E+14, 1.768E+14, 1.883E+14, 2.001E+14, 2.120E+14, 2.242E+14, 2.365E+14, 2.489E+14, 2.615E+14, 2.741E+14, 2.869E+14, 2.997E+14, 3.126E+14, 3.255E+14, 3.385E+14, 3.515E+14, 3.646E+14, 3.778E+14, 3.910E+14, 4.045E+14, 4.181E+14, 4.320E+14, 4.461E+14, 4.607E+14, 4.759E+14, 4.917E+14, 5.086E+14, 5.268E+14, 5.469E+14, 5.700E+14, 5.975E+14, 6.035E+14, 6.097E+14, 6.163E+14, 6.232E+14, 6.304E+14, 6.381E+14, 6.462E+14, 6.548E+14, 6.640E+14, 6.739E+14, 6.845E+14, 6.960E+14, 7.085E+14, 7.222E+14, 7.373E+14, 7.539E+14, 7.724E+14, 7.931E+14, 8.162E+14, 8.421E+14, 8.714E+14, 9.046E+14, 9.423E+14, 9.852E+14, 1.034E+15, 1.090E+15, 1.155E+15, 1.229E+15, 1.315E+15, 1.414E+15, 1.529E+15, 1.663E+15, 1.818E+15, 2.000E+15, 2.211E+15, 3.931E+15, 7.628E+15, 1.531E+16, 3.058E+16, 5.958E+16, 1.125E+17, 2.079E+17, 3.888E+17, 7.589E+17, 1.555E+18, 3.309E+18, 7.274E+18, 1.645E+19, 3.607E+19, 7.232E+19, 1.332E+20
]

H = [
    4.257E+12, 4.446E+12, 4.632E+12, 4.816E+12, 4.997E+12, 5.175E+12, 5.351E+12, 5.523E+12, 5.692E+12, 5.857E+12, 6.020E+12, 6.178E+12, 6.334E+12, 6.485E+12, 6.633E+12, 6.778E+12, 6.919E+12, 7.056E+12, 7.189E+12, 7.319E+12, 7.445E+12, 7.568E+12, 7.687E+12, 7.803E+12, 7.915E+12, 8.024E+12, 8.130E+12, 8.233E+12, 8.332E+12, 8.429E+12, 8.524E+12, 8.617E+12, 8.708E+12, 8.798E+12, 8.889E+12, 8.981E+12, 9.076E+12, 9.177E+12, 9.287E+12, 9.413E+12, 9.562E+12, 9.747E+12, 9.988E+12, 1.032E+13, 1.078E+13, 1.145E+13, 1.245E+13, 1.398E+13, 1.633E+13, 1.692E+13, 1.756E+13, 1.825E+13, 1.901E+13, 1.984E+13, 2.075E+13, 2.174E+13, 2.281E+13, 2.399E+13, 2.527E+13, 2.668E+13, 2.822E+13, 2.991E+13, 3.177E+13, 3.382E+13, 3.609E+13, 3.861E+13, 4.142E+13, 4.456E+13, 4.808E+13, 5.204E+13, 5.653E+13, 6.162E+13, 6.740E+13, 7.400E+13, 8.152E+13, 9.007E+13, 9.975E+13, 1.105E+14, 1.223E+14, 1.346E+14, 1.467E+14, 1.573E+14, 1.650E+14, 1.694E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14, 1.707E+14
]

Ar = [
    1.847E+01, 8.508E+01, 3.148E+02, 1.074E+03, 3.486E+03, 1.083E+04, 3.236E+04, 9.301E+04, 2.576E+05, 6.884E+05, 1.775E+06, 4.424E+06, 1.067E+07, 2.491E+07, 5.635E+07, 1.236E+08, 2.635E+08, 5.454E+08, 1.099E+09, 2.155E+09, 4.118E+09, 7.678E+09, 1.398E+10, 2.488E+10, 4.331E+10, 7.384E+10, 1.234E+11, 2.024E+11, 3.261E+11, 5.168E+11, 8.065E+11, 1.241E+12, 1.884E+12, 2.829E+12, 4.204E+12, 6.195E+12, 9.067E+12, 1.321E+13, 1.919E+13, 2.788E+13, 4.063E+13, 5.963E+13, 8.851E+13, 1.339E+14, 2.087E+14, 3.403E+14, 5.955E+14, 1.167E+15, 2.654E+15, 3.165E+15, 3.798E+15, 4.585E+15, 5.566E+15, 6.792E+15, 8.326E+15, 1.025E+16, 1.266E+16, 1.569E+16, 1.947E+16, 2.422E+16, 3.013E+16, 3.750E+16, 4.660E+16, 5.786E+16, 7.169E+16, 8.857E+16, 1.091E+17, 1.338E+17, 1.636E+17, 1.992E+17, 2.416E+17, 2.919E+17, 3.515E+17, 4.219E+17, 5.049E+17, 6.028E+17, 7.180E+17, 8.537E+17, 1.013E+18, 1.201E+18, 1.422E+18, 1.682E+18, 1.987E+18, 2.346E+18, 5.321E+18, 1.181E+19, 2.543E+19, 5.260E+19, 1.043E+20, 1.986E+20, 3.686E+20, 6.911E+20, 1.351E+21, 2.769E+21, 5.895E+21, 1.296E+22, 2.931E+22, 6.429E+22, 1.289E+23, 2.374E+23
]

colden = xr.Dataset(
    data_vars = {
        'N2': ('level', N2, { 'units': 'cm-2' }),
        'O2': ('level', O2, { 'units': 'cm-2' }),
        'O': ('level', O, { 'units': 'cm-2' }),
        'O3': ('level', O3, { 'units': 'cm-2' }),
        'NO': ('level', NO, { 'units': 'cm-2' }),
        'N': ('level', N, { 'units': 'cm-2' }),
        'He': ('level', He, { 'units': 'cm-2' }),
        'H': ('level', H, { 'units': 'cm-2' }),
        'Ar': ('level', Ar, { 'units': 'cm-2' })
    },
    coords = {
        'level': ('level', altitudes, { 'units': 'km' })
    }
)

with ProgressBar():
    colden.to_netcdf('../../data/colden.nc', compute=False).compute()

print(colden)