import matplotlib.pyplot as plt

import xarray as xr
from dask.diagnostics import ProgressBar

import numpy as np

altitudes = [
    1000.00, 955.94, 913.82, 873.56, 835.07, 798.28, 763.11, 729.49, 697.35, 666.62, 637.25, 609.18, 582.34, 556.68, 532.15, 508.71, 486.29, 464.87, 444.39, 424.81, 406.09, 388.20, 371.10, 354.75, 339.12, 324.18, 309.89, 296.24, 283.19, 270.71, 258.78, 247.38, 236.48, 226.06, 216.10, 206.58, 197.48, 188.78, 180.46, 172.51, 164.91, 157.64, 150.70, 144.06, 137.71, 131.64, 125.84, 120.30, 115.00, 114.00, 113.00, 112.00, 111.00, 110.00, 109.00, 108.00, 107.00, 106.00, 105.00, 104.00, 103.00, 102.00, 101.00, 100.00, 99.00, 98.00, 97.00, 96.00, 95.00, 94.00, 93.00, 92.00, 91.00, 90.00, 89.00, 88.00, 87.00, 86.00, 85.00, 84.00, 83.00, 82.00, 81.00, 80.00, 75.00, 70.00, 65.00, 60.00, 55.00, 50.00, 45.00, 40.00, 35.00, 30.00, 25.00, 20.00, 15.00, 10.00, 5.00, 0.00
]

NO_plus = [
    9.434E-01, 9.199E-01, 9.048E-01, 9.377E-01, 1.131E+00, 1.777E+00, 3.575E+00, 8.035E+00, 1.810E+01, 3.905E+01, 7.765E+01, 1.420E+02, 2.407E+02, 3.741E+02, 5.401E+02, 7.470E+02, 9.802E+02, 1.212E+03, 1.481E+03, 1.793E+03, 2.132E+03, 2.492E+03, 2.852E+03, 3.314E+03, 3.893E+03, 4.608E+03, 5.515E+03, 6.689E+03, 8.234E+03, 1.031E+04, 1.276E+04, 1.622E+04, 2.127E+04, 2.767E+04, 3.595E+04, 4.597E+04, 5.829E+04, 7.057E+04, 8.306E+04, 9.416E+04, 1.025E+05, 1.064E+05, 1.054E+05, 9.887E+04, 8.787E+04, 7.378E+04, 5.968E+04, 4.901E+04, 4.223E+04, 4.131E+04, 3.996E+04, 3.957E+04, 3.825E+04, 3.651E+04, 3.472E+04, 3.272E+04, 3.032E+04, 2.853E+04, 2.610E+04, 2.348E+04, 2.117E+04, 1.907E+04, 1.657E+04, 1.452E+04, 1.340E+04, 1.241E+04, 1.153E+04, 1.063E+04, 9.582E+03, 8.276E+03, 6.694E+03, 5.048E+03, 3.605E+03, 2.415E+03, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

O2_plus = [
    9.688E-01, 9.513E-01, 9.271E-01, 8.957E-01, 8.583E-01, 8.192E-01, 7.923E-01, 8.095E-01, 9.419E-01, 1.330E+00, 2.234E+00, 4.079E+00, 7.467E+00, 1.318E+01, 2.218E+01, 3.528E+01, 5.341E+01, 7.793E+01, 1.098E+02, 1.499E+02, 2.022E+02, 2.727E+02, 3.740E+02, 5.046E+02, 6.790E+02, 9.147E+02, 1.231E+03, 1.652E+03, 2.218E+03, 2.976E+03, 3.850E+03, 5.159E+03, 7.038E+03, 9.361E+03, 1.234E+04, 1.606E+04, 2.054E+04, 2.553E+04, 3.094E+04, 3.645E+04, 4.172E+04, 4.647E+04, 5.025E+04, 5.267E+04, 5.398E+04, 5.500E+04, 5.719E+04, 6.425E+04, 8.024E+04, 8.426E+04, 8.759E+04, 9.327E+04, 9.732E+04, 1.009E+05, 1.057E+05, 1.101E+05, 1.136E+05, 1.198E+05, 1.230E+05, 1.231E+05, 1.238E+05, 1.219E+05, 1.153E+05, 1.062E+05, 9.214E+04, 7.550E+04, 5.804E+04, 4.072E+04, 2.568E+04, 1.422E+04, 6.911E+03, 3.071E+03, 1.348E+03, 5.984E+02, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

O_plus = [
    7.769E+01, 1.304E+02, 2.158E+02, 3.514E+02, 5.634E+02, 8.907E+02, 1.383E+03, 2.113E+03, 3.167E+03, 4.648E+03, 6.704E+03, 9.471E+03, 1.308E+04, 1.775E+04, 2.365E+04, 3.106E+04, 4.035E+04, 5.207E+04, 6.676E+04, 8.520E+04, 1.082E+05, 1.362E+05, 1.701E+05, 2.095E+05, 2.542E+05, 3.027E+05, 3.529E+05, 4.019E+05, 4.454E+05, 4.787E+05, 4.975E+05, 4.974E+05, 4.772E+05, 4.390E+05, 3.876E+05, 3.301E+05, 2.709E+05, 2.156E+05, 1.662E+05, 1.232E+05, 8.682E+04, 5.743E+04, 3.514E+04, 1.948E+04, 9.558E+03, 4.065E+03, 1.486E+03, 4.787E+02, 1.515E+02, 1.223E+02, 9.850E+01, 7.865E+01, 6.262E+01, 4.941E+01, 3.852E+01, 2.953E+01, 2.239E+01, 1.650E+01, 1.174E+01, 8.274E+00, 5.577E+00, 3.670E+00, 2.349E+00, 1.430E+00, 8.399E-01, 4.751E-01, 2.521E-01, 1.302E-01, 6.633E-02, 3.177E-02, 1.482E-02, 6.741E-03, 2.828E-03, 1.138E-03, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

N_4So = [
    1.313E+00, 1.633E+00, 2.420E+00, 4.351E+00, 9.044E+00, 2.029E+01, 4.671E+01, 1.072E+02, 2.416E+02, 5.319E+02, 1.130E+03, 2.315E+03, 4.554E+03, 8.564E+03, 1.532E+04, 2.619E+04, 4.291E+04, 6.792E+04, 1.041E+05, 1.562E+05, 2.303E+05, 3.342E+05, 4.787E+05, 6.750E+05, 9.380E+05, 1.284E+06, 1.729E+06, 2.288E+06, 2.971E+06, 3.787E+06, 4.739E+06, 5.820E+06, 7.026E+06, 8.344E+06, 9.743E+06, 1.115E+07, 1.248E+07, 1.361E+07, 1.439E+07, 1.468E+07, 1.438E+07, 1.343E+07, 1.186E+07, 9.796E+06, 7.510E+06, 5.367E+06, 3.669E+06, 2.636E+06, 2.226E+06, 2.183E+06, 2.159E+06, 2.125E+06, 2.083E+06, 2.024E+06, 1.951E+06, 1.855E+06, 1.734E+06, 1.591E+06, 1.435E+06, 1.266E+06, 1.096E+06, 9.218E+05, 7.596E+05, 6.008E+05, 4.501E+05, 3.227E+05, 2.203E+05, 1.424E+05, 8.610E+04, 4.835E+04, 2.531E+04, 1.254E+04, 5.903E+03, 2.572E+03, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

N_plus = [
    8.764E+00, 1.323E+01, 1.994E+01, 3.021E+01, 4.630E+01, 7.220E+01, 1.150E+02, 1.863E+02, 3.033E+02, 4.899E+02, 7.715E+02, 1.171E+03, 1.698E+03, 2.378E+03, 3.066E+03, 3.896E+03, 4.682E+03, 5.497E+03, 6.274E+03, 7.060E+03, 7.792E+03, 8.452E+03, 8.992E+03, 9.400E+03, 9.643E+03, 9.684E+03, 9.510E+03, 9.132E+03, 8.558E+03, 7.828E+03, 6.974E+03, 6.078E+03, 5.198E+03, 4.379E+03, 3.657E+03, 3.042E+03, 2.517E+03, 2.068E+03, 1.675E+03, 1.324E+03, 1.009E+03, 7.320E+02, 4.965E+02, 3.088E+02, 1.721E+02, 8.454E+01, 3.698E+01, 1.552E+01, 6.958E+00, 5.987E+00, 5.131E+00, 4.363E+00, 3.669E+00, 3.038E+00, 2.471E+00, 1.968E+00, 1.530E+00, 1.159E+00, 8.548E-01, 6.125E-01, 4.254E-01, 2.862E-01, 1.859E-01, 1.158E-01, 6.931E-02, 3.966E-02, 2.166E-02, 1.134E-02, 5.715E-03, 2.777E-03, 1.307E-03, 5.916E-04, 2.525E-04, 9.892E-05, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

N2_plus = [
    5.110E-01, 9.141E-01, 1.677E+00, 3.128E+00, 5.851E+00, 1.085E+01, 1.971E+01, 3.479E+01, 5.930E+01, 9.724E+01, 1.529E+02, 2.308E+02, 3.364E+02, 4.690E+02, 6.361E+02, 8.260E+02, 1.039E+03, 1.261E+03, 1.486E+03, 1.710E+03, 1.932E+03, 2.152E+03, 2.372E+03, 2.596E+03, 2.828E+03, 3.069E+03, 3.320E+03, 3.579E+03, 3.851E+03, 4.130E+03, 4.409E+03, 4.674E+03, 4.905E+03, 5.072E+03, 5.142E+03, 5.094E+03, 4.912E+03, 4.591E+03, 4.145E+03, 3.597E+03, 2.981E+03, 2.336E+03, 1.711E+03, 1.155E+03, 7.055E+02, 3.866E+02, 1.919E+02, 9.232E+01, 4.976E+01, 4.480E+01, 4.033E+01, 3.614E+01, 3.212E+01, 2.817E+01, 2.435E+01, 2.062E+01, 1.707E+01, 1.380E+01, 1.086E+01, 8.310E+00, 6.160E+00, 4.424E+00, 3.065E+00, 2.038E+00, 1.301E+00, 7.936E-01, 4.619E-01, 2.575E-01, 1.377E-01, 7.077E-02, 3.507E-02, 1.660E-02, 7.359E-03, 2.975E-03, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

O_plus_2Do = [
    3.054E+02, 4.784E+02, 7.186E+02, 1.034E+03, 1.429E+03, 1.894E+03, 2.425E+03, 3.001E+03, 3.594E+03, 4.174E+03, 4.693E+03, 5.122E+03, 5.434E+03, 5.582E+03, 5.608E+03, 5.461E+03, 5.194E+03, 4.818E+03, 4.381E+03, 3.918E+03, 3.468E+03, 3.038E+03, 2.644E+03, 2.288E+03, 1.968E+03, 1.684E+03, 1.433E+03, 1.212E+03, 1.020E+03, 8.539E+02, 7.113E+02, 5.887E+02, 4.843E+02, 3.952E+02, 3.193E+02, 2.547E+02, 2.000E+02, 1.538E+02, 1.152E+02, 8.338E+01, 5.779E+01, 3.788E+01, 2.319E+01, 1.300E+01, 6.518E+00, 2.853E+00, 1.077E+00, 3.634E-01, 1.245E-01, 1.020E-01, 8.320E-02, 6.752E-02, 5.403E-02, 4.257E-02, 3.283E-02, 2.470E-02, 1.806E-02, 1.281E-02, 8.783E-03, 5.807E-03, 3.694E-03, 2.252E-03, 1.312E-03, 7.257E-04, 3.798E-04, 1.874E-04, 8.690E-05, 3.790E-05, 1.559E-05, 6.050E-06, 2.213E-06, 7.561E-07, 2.358E-07, 6.525E-08, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

O_plus_2Po = [
    5.212E-02, 8.807E-02, 1.462E-01, 2.388E-01, 3.836E-01, 6.064E-01, 9.428E-01, 1.444E+00, 2.179E+00, 3.238E+00, 4.742E+00, 6.848E+00, 9.743E+00, 1.367E+01, 1.891E+01, 2.579E+01, 3.467E+01, 4.590E+01, 5.982E+01, 7.662E+01, 9.644E+01, 1.188E+02, 1.432E+02, 1.684E+02, 1.930E+02, 2.151E+02, 2.331E+02, 2.454E+02, 2.512E+02, 2.503E+02, 2.431E+02, 2.299E+02, 2.122E+02, 1.910E+02, 1.677E+02, 1.435E+02, 1.196E+02, 9.660E+01, 7.548E+01, 5.668E+01, 4.057E+01, 2.736E+01, 1.718E+01, 9.844E+00, 5.020E+00, 2.220E+00, 8.402E-01, 2.830E-01, 9.713E-02, 7.968E-02, 6.512E-02, 5.294E-02, 4.246E-02, 3.352E-02, 2.590E-02, 1.954E-02, 1.431E-02, 1.017E-02, 6.987E-03, 4.626E-03, 2.947E-03, 1.799E-03, 1.049E-03, 5.806E-04, 3.042E-04, 1.503E-04, 6.973E-05, 3.045E-05, 1.254E-05, 4.869E-06, 1.783E-06, 6.094E-07, 1.902E-07, 5.263E-08, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

N_2Do = [
    9.076E+00, 1.990E+01, 4.462E+01, 1.012E+02, 2.289E+02, 5.094E+02, 1.098E+03, 2.271E+03, 4.472E+03, 8.353E+03, 1.470E+04, 2.437E+04, 3.823E+04, 5.641E+04, 7.917E+04, 1.062E+05, 1.368E+05, 1.691E+05, 2.045E+05, 2.429E+05, 2.835E+05, 3.268E+05, 3.717E+05, 4.217E+05, 4.761E+05, 5.344E+05, 5.962E+05, 6.610E+05, 7.270E+05, 7.932E+05, 8.497E+05, 9.020E+05, 9.492E+05, 9.772E+05, 9.851E+05, 9.675E+05, 9.265E+05, 8.545E+05, 7.618E+05, 6.517E+05, 5.304E+05, 4.057E+05, 2.873E+05, 1.844E+05, 1.052E+05, 5.264E+04, 2.359E+04, 1.034E+04, 4.858E+03, 4.219E+03, 3.615E+03, 3.141E+03, 2.654E+03, 2.197E+03, 1.798E+03, 1.442E+03, 1.124E+03, 8.767E+02, 6.560E+02, 4.734E+02, 3.369E+02, 2.337E+02, 1.532E+02, 9.776E+01, 6.159E+01, 3.727E+01, 2.161E+01, 1.178E+01, 5.958E+00, 2.755E+00, 1.165E+00, 4.624E-01, 1.773E-01, 6.340E-02, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

N_2Po = [
    5.901E-05, 1.476E-04, 3.583E-04, 8.445E-04, 1.935E-03, 4.308E-03, 9.335E-03, 1.969E-02, 4.045E-02, 8.099E-02, 1.582E-01, 3.013E-01, 5.608E-01, 1.019E+00, 1.811E+00, 3.146E+00, 5.350E+00, 8.895E+00, 1.449E+01, 2.308E+01, 3.596E+01, 5.480E+01, 8.157E+01, 1.184E+02, 1.674E+02, 2.301E+02, 3.070E+02, 3.974E+02, 4.982E+02, 6.060E+02, 7.157E+02, 8.244E+02, 9.308E+02, 1.035E+03, 1.135E+03, 1.225E+03, 1.292E+03, 1.323E+03, 1.306E+03, 1.234E+03, 1.109E+03, 9.367E+02, 7.316E+02, 5.172E+02, 3.223E+02, 1.743E+02, 8.486E+01, 4.276E+01, 2.671E+01, 2.493E+01, 2.329E+01, 2.169E+01, 2.006E+01, 1.834E+01, 1.653E+01, 1.463E+01, 1.267E+01, 1.072E+01, 8.841E+00, 7.099E+00, 5.533E+00, 4.181E+00, 3.054E+00, 2.144E+00, 1.446E+00, 9.337E-01, 5.757E-01, 3.402E-01, 1.928E-01, 1.049E-01, 5.485E-02, 2.729E-02, 1.263E-02, 5.294E-03, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

O_1D = [
    1.019E-01, 1.805E-01, 3.158E-01, 5.447E-01, 9.282E-01, 1.562E+00, 2.600E+00, 4.286E+00, 6.994E+00, 1.133E+01, 1.827E+01, 2.935E+01, 4.699E+01, 7.523E+01, 1.201E+02, 1.912E+02, 3.023E+02, 4.751E+02, 7.398E+02, 1.140E+03, 1.740E+03, 2.611E+03, 3.867E+03, 5.615E+03, 8.020E+03, 1.126E+04, 1.546E+04, 2.061E+04, 2.636E+04, 3.201E+04, 3.646E+04, 3.936E+04, 4.055E+04, 3.998E+04, 3.818E+04, 3.556E+04, 3.244E+04, 2.899E+04, 2.543E+04, 2.192E+04, 1.859E+04, 1.562E+04, 1.316E+04, 1.132E+04, 1.018E+04, 9.666E+03, 9.482E+03, 9.006E+03, 7.493E+03, 7.044E+03, 6.601E+03, 6.000E+03, 5.420E+03, 4.845E+03, 4.286E+03, 3.741E+03, 3.242E+03, 2.804E+03, 2.413E+03, 2.064E+03, 1.760E+03, 1.493E+03, 1.240E+03, 1.050E+03, 8.718E+02, 7.334E+02, 5.878E+02, 4.789E+02, 4.092E+02, 3.168E+02, 2.579E+02, 2.222E+02, 1.776E+02, 1.500E+02, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

O_1S = [
    5.520E-05, 9.834E-05, 1.729E-04, 2.998E-04, 5.130E-04, 8.661E-04, 1.445E-03, 2.383E-03, 3.881E-03, 6.260E-03, 1.001E-02, 1.588E-02, 2.501E-02, 3.925E-02, 6.142E-02, 9.593E-02, 1.498E-01, 2.345E-01, 3.674E-01, 5.771E-01, 9.077E-01, 1.422E+00, 2.217E+00, 3.447E+00, 5.360E+00, 8.354E+00, 1.301E+01, 2.012E+01, 3.048E+01, 4.489E+01, 6.391E+01, 8.803E+01, 1.182E+02, 1.553E+02, 2.010E+02, 2.567E+02, 3.233E+02, 4.009E+02, 4.874E+02, 5.792E+02, 6.683E+02, 7.439E+02, 7.919E+02, 7.966E+02, 7.468E+02, 6.481E+02, 5.347E+02, 4.676E+02, 4.903E+02, 5.046E+02, 5.199E+02, 5.345E+02, 5.456E+02, 5.496E+02, 5.453E+02, 5.307E+02, 5.040E+02, 4.668E+02, 4.196E+02, 3.653E+02, 3.070E+02, 2.483E+02, 1.921E+02, 1.411E+02, 9.794E+01, 6.384E+01, 3.885E+01, 2.207E+01, 1.168E+01, 5.758E+00, 2.643E+00, 1.114E+00, 4.213E-01, 1.379E-01, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

N2_A = [
    1.062E-06, 2.801E-06, 7.196E-06, 1.801E-05, 4.394E-05, 1.045E-04, 2.425E-04, 5.501E-04, 1.218E-03, 2.643E-03, 5.617E-03, 1.172E-02, 2.404E-02, 4.855E-02, 9.673E-02, 1.902E-01, 3.703E-01, 7.124E-01, 1.355E+00, 2.546E+00, 4.700E+00, 8.466E+00, 1.483E+01, 2.520E+01, 4.159E+01, 6.685E+01, 1.047E+02, 1.593E+02, 2.337E+02, 3.291E+02, 4.447E+02, 5.772E+02, 7.239E+02, 8.804E+02, 1.042E+03, 1.203E+03, 1.352E+03, 1.477E+03, 1.565E+03, 1.598E+03, 1.565E+03, 1.457E+03, 1.272E+03, 1.025E+03, 7.467E+02, 4.827E+02, 2.795E+02, 1.574E+02, 1.011E+02, 9.461E+01, 8.867E+01, 8.287E+01, 7.699E+01, 7.062E+01, 6.389E+01, 5.679E+01, 4.939E+01, 4.200E+01, 3.481E+01, 2.811E+01, 2.205E+01, 1.679E+01, 1.237E+01, 8.769E+00, 5.985E+00, 3.918E+00, 2.453E+00, 1.476E+00, 8.536E-01, 4.749E-01, 2.545E-01, 1.297E-01, 6.155E-02, 2.639E-02, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00
]

chemden = xr.Dataset(
    data_vars = {
        'NO+': ('level', NO_plus, { 'units': 'cm-3' }),
        'O2+': ('level', O2_plus, { 'units': 'cm-3' }),
        'O+': ('level', O_plus, { 'units': 'cm-3' }),
        'N(4So)': ('level', N_4So, { 'units': 'cm-3' }),
        'N+': ('level', N_plus, { 'units': 'cm-3' }),
        'N2+': ('level', N2_plus, { 'units': 'cm-3' }),
        'O+(2Do)': ('level', O_plus_2Do, { 'units': 'cm-3' }),
        'O+(2Po)': ('level', O_plus_2Po, { 'units': 'cm-3' }),
        'N(2Do)': ('level', N_2Do, { 'units': 'cm-3' }),
        'N(2Po)': ('level', N_2Po, { 'units': 'cm-3'}),
        'O(1D)': ('level', O_1D, { 'units': 'cm-3' }),
        'O(1S)': ('level', O_1S, { 'units': 'cm-3' }),
        'N2(A)': ('level', N2_A, { 'units': 'cm-3' })
    },
    coords = {
        'level': ('level', altitudes, { 'units': 'km' })
    }
)

with ProgressBar():
    chemden.to_netcdf('../../data/chemden.nc', compute=False).compute()

print(chemden)